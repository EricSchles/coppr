# memory map
# mc-5 = 27 - state
# mc-4 = 28 - BIC
# mc-3 = 29 - TH
# mc-2 = 30 - TD
# mc-1 = 31 - TB
# data struct for blocks - +0:blockheader[:32]
#						   +1:blockheader[32:64]
#						   +2:blockheader[64:]
#						   +3:index
#						   +4:height
#						   +5:cumulative diff
#						   +6:num history
#						   +7...:history items
# check txvalue high enough
PUSH loc:end PUSH 01ff BASEFEE MUL TXVALUE GT JMPI

# check state, go to loaddata if done
PUSH loc:loaddata PUSH 27 SLOAD PUSH 01 EQ JMPI

:init
# save genesis block - hardcode values to avoid needing to hash them
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000 DUP PUSH 03 MSTORE
	# add to start of index
	PUSH 32 SSTORE
PUSH 0100000000000000000000000000000000000000000000000000000000000000
PUSH 000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa
PUSH 4b1e5e4a29ab5f49ffff001d1dac2b7c
PUSH 00
PUSH 00
PUSH 010000
PUSH 01
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000007 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000006 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000005 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000004 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000003 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000002 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000001 SSTORE 
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000 SSTORE 
PUSH 01 PUSH 28 SSTORE
PUSH 00 PUSH 29 SSTORE
PUSH 010000 PUSH 30 SSTORE
PUSH 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000 PUSH 31 SSTORE

# record state = 1
PUSH 01 PUSH 27 SSTORE

# load tx data into chunks and store in memory slots 0,1,2
:loaddata
PUSH 00 TXDATA PUSH 01 TXDATA PUSH 02 TXDATA 
PUSH 02 MSTORE PUSH 01 MSTORE PUSH 00 MSTORE

:store

PUSH 00 PUSH 80 SHA256 PUSH 03 MSTORE
PUSH 03 PUSH 32 SHA256 DUP PUSH 03 MSTORE


FAIL



# SCRATCH PAD

# convert target to diff. First target is diff1, second is from block
PUSH 0000FFFF00000000000000000000000000000000000000000000000000000000 PUSH 00000000FFFF0000000000000000000000000000000000000000000000000000 DIV


FAIL